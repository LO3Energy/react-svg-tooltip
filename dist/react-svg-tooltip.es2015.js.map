{"version":3,"file":"react-svg-tooltip.es2015.js","sources":["../src/svg-point.ts","../src/Tooltip.tsx"],"sourcesContent":["/**\n * Returns the *x* and *y* coordinates of the mouse relative to the svg root container element.\n * The coordinates are returned as an array of two-elements \\[*x*, *y*].\n * Inspired by https://raw.githubusercontent.com/d3/d3-selection/master/src/point.js\n * @param svg the root svg container element\n * @param event the mouse event\n */\nconst svgPoint = (svg: SVGSVGElement, event: MouseEvent) => {\n    if (svg.createSVGPoint) {\n        let point = svg.createSVGPoint();\n        point.x = event.clientX;\n        point.y = event.clientY;\n        point = point.matrixTransform(svg.getScreenCTM().inverse());\n        return [point.x, point.y];\n    }\n    const rect = svg.getBoundingClientRect();\n    return [event.clientX - rect.left - svg.clientLeft, event.clientY - rect.top - svg.clientTop];\n};\n\nexport default svgPoint;\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport svgPoint from './svg-point';\n\nexport type Props = {\n    readonly for: React.RefObject<SVGElement>\n};\n\nexport type TooltipHidden = {\n    readonly type: 'TooltipHidden'\n};\n\nexport type TooltipVisible = {\n    readonly type: 'TooltipVisible'\n    readonly svgSvgElement: SVGSVGElement;\n    readonly x: number\n    readonly y: number\n};\n\nexport type State = TooltipHidden | TooltipVisible;\n\nexport class TooltipComponent extends React.Component<Props, State> {\n\n    readonly state: Readonly<State> = {type: 'TooltipHidden'};\n\n    componentDidMount() {\n        const mouseTrigger = this.props.for.current;\n        if (mouseTrigger) {\n            mouseTrigger.addEventListener(`mouseover`, this.updateTooltipListener);\n            mouseTrigger.addEventListener(`mousemove`, this.updateTooltipListener);\n            mouseTrigger.addEventListener(`mouseleave`, this.hideTooltipListener);\n        }\n    }\n\n    render() {\n        if (this.state.type === 'TooltipHidden') {\n            return <g/>;\n        } else {\n            const x = this.state.x;\n            const y = this.state.y;\n\n            const tooltip =\n                (\n                    <g\n                        className=\"Tooltip\"\n                        pointerEvents=\"none\" // tooltip should never grab mouse > prevent flickering\n                    >\n                        {\n                            React.Children.map(this.props.children, child => {\n                                return React.cloneElement(child as React.ReactElement<any>, { \n                                    x, \n                                    y,\n                                });\n                            })\n                        }\n                    </g>\n                );\n\n            return ReactDOM.createPortal(tooltip, this.state.svgSvgElement);\n        }\n    }\n\n    componentWillUnmount() {\n        const mouseTrigger = this.props.for.current;\n        if (mouseTrigger) {\n            mouseTrigger.removeEventListener(`mouseover`, this.updateTooltipListener);\n            mouseTrigger.removeEventListener(`mousemove`, this.updateTooltipListener);\n            mouseTrigger.removeEventListener(`mouseleave`, this.hideTooltipListener);\n        }\n    }\n\n    private readonly updateTooltipListener = (evt: MouseEvent) => {\n        const mouseTrigger = this.props.for.current;\n        if (mouseTrigger) {\n            if (mouseTrigger.ownerSVGElement) {\n                const mousePosition = svgPoint(mouseTrigger.ownerSVGElement, evt);\n                this.setState({\n                    type: 'TooltipVisible',\n                    svgSvgElement: mouseTrigger.ownerSVGElement,\n                    x: mousePosition[0],\n                    y: mousePosition[1]\n                });\n            }\n        }\n    }\n\n    private readonly hideTooltipListener = () => this.setState({type: 'TooltipHidden'});\n\n}\n\nexport default TooltipComponent;\n"],"names":["React.Component","React.createElement","React.Children","React.cloneElement","ReactDOM.createPortal"],"mappings":"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"}